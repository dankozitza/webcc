<!DOCTYPE html>


<html>
<head>
   <meta charset="UTF-8" />
   <title>Control Center</title>
</head>
<body id="main">

<style>
   td {
      border: 1px solid grey;
      background-color: white;
   }
   body {
      background-color: tan;
   }
</style>

<script>
// buildcollumbs
//
// takes an object and iterates through it's properties returning a string
// with td tags wrapped around the values of the object's properties. expected
// to be used on stat objects. colors the td tags if the Status property is
// found.
//
function buildcollumbs(s) {
   ret = "";
   for (k in s) {
      if (k == "Status") {
         c = "green";
         if (s[k] == "WARN") {
            c = "yellow";
         }
         else if (s[k] == "ERROR" || s[k] == "PANIC") {
            c = "red";
         }
         ret += "<td style=\"background-color:" + c + "\">" + s[k] + "</td>"
      }
      else {
         ret += "<td>" + s[k] + "</td>"
      }
   }
   return ret;
}
</script>

<center>

<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', "/clientconf", false);
xhr.send();
var config = eval('(' + xhr.response + ')');
var body = document.querySelector("#main");
if (config.body["backgroundColor"]) {
   body.style.backgroundColor = config.body["backgroundColor"];
}
for (linkName in config.Links) {
   document.write(
      "<a href=\"" + config.Links[linkName] + "\">" + linkName + "</a>&nbsp;");
}
</script>

<h1>Distribution Center</h1>
<br>
<h2>statdist</h2>

<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', "/statdist", false);
xhr.send();

// creat an object from the statdist JSON
var statMap = eval('(' + xhr.response + ')');

// display statMap
var i = 0;
document.write("<table>");// style=\"table-layout:fixed;width:800px\">")
document.write("<tr>" + buildcollumbs(Object.keys(statMap["0"])) + "</tr>")
while (statMap[i.toString()]) {
   document.write("<tr>" + buildcollumbs(statMap[i.toString()]) + "</tr>")
   i++;
}
document.write("</table>")
</script>

<h2>clientconf</h2>

<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', "/clientconf", false);
xhr.send();

document.write("<table><tr><td>");
document.write(xhr.response);
document.write("</td></tr></table>");
</script>

<h2>stdout</h2>

<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', "/stdout", false);
xhr.send();

document.write("<table><tr><td>");
document.write(xhr.response);
document.write("</td></tr></table>");
</script>

<h2>access</h2>

<script>
var xhr = new XMLHttpRequest();
xhr.open('GET', "/access", false);
xhr.send();

document.write("<table><tr><td>");
document.write(xhr.response);
document.write("</td></tr></table>");
</script>

</center>
</body>
</html>
